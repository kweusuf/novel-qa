services:
  novel-qa:
    build: 
      context: .
      dockerfile: Dockerfile.dev
    ports:
      - "8080:8080"
    volumes:
      - .:/app
      - /app/go.mod
      - /app/go.sum
      - novel_data:/app/novels
      - chroma_data:/app/chroma_db
    environment:
      - OLLAMA_HOST=http://host.docker.internal:11434
      - GIN_MODE=debug
    restart: unless-stopped
    networks:
      - novel-qa-network
    command: ["air", "-c", ".air.toml"]

volumes:
  novel_data:
    driver: local
  chroma_data:
    driver: local

networks:
  novel-qa-network:
    driver: bridge

